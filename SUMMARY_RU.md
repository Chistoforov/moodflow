# üì± –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ OAuth –¥–ª—è APK - –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google SSO –≤ APK –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –±—Ä–∞—É–∑–µ—Ä –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±—Ä–∞—Ç–Ω–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Å—Ç–∞–≤–∞–ª–æ—Å—å –Ω–∞ —ç–∫—Ä–∞–Ω–µ "–í—Ö–æ–¥..." –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω **polling –º–µ—Ö–∞–Ω–∏–∑–º**: –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ—Ä–Ω—É–ª—Å—è –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞.

---

## üîß –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –ö–æ–¥:
1. **`src/app/(auth)/login/page.tsx`**
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω polling (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫, —Ç–∞–π–º–∞—É—Ç 5 –º–∏–Ω—É—Ç)
   - –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

2. **`src/app/(auth)/callback/page.tsx`**
   - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è "–ó–∞–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ –∏ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
   - –ü–æ–ø—ã—Ç–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä

3. **`src/app/api/auth/status/route.ts`** (–Ω–æ–≤—ã–π)
   - API –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

4. **`next.config.ts`**
   - –î–æ–±–∞–≤–ª–µ–Ω—ã headers –¥–ª—è assetlinks.json

5. **`public/.well-known/assetlinks.json`** (–Ω–æ–≤—ã–π)
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Android App Links (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è APK:
1. –ù–∞–∂–∏–º–∞–µ—Ç "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google" –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä —Å OAuth —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π Google
3. –ó–∞–≤–µ—Ä—à–∞–µ—Ç –≤—Ö–æ–¥ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
4. –í–∏–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ: "‚úÖ –í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω! –ó–∞–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ..."
5. –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä
6. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π)
7. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é** (2-5 —Å–µ–∫—É–Ω–¥)
8. –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—å ‚úÖ

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏:
```javascript
// Polling –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
setInterval(async () => {
  const { data: { session } } = await supabase.auth.getSession()
  if (session) {
    router.push('/calendar') // –£—Å–ø–µ—Ö!
  }
}, 2000)
```

---

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### –®–∞–≥ 1: –î–µ–ø–ª–æ–π (2 –º–∏–Ω—É—Ç—ã)
```bash
cd /Users/d.chistoforov/moodflow
git add .
git commit -m "Fix mobile OAuth with polling mechanism"
git push
```

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase (2 –º–∏–Ω—É—Ç—ã)
1. https://app.supabase.com ‚Üí –≤–∞—à –ø—Ä–æ–µ–∫—Ç
2. **Authentication ‚Üí URL Configuration ‚Üí Redirect URLs**
3. –î–æ–±–∞–≤—å—Ç–µ:
   ```
   https://moodflow-six.vercel.app/callback
   https://moodflow-six.vercel.app/api/auth/callback
   ```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Cloud Console (3 –º–∏–Ω—É—Ç—ã)
1. https://console.cloud.google.com ‚Üí –≤–∞—à –ø—Ä–æ–µ–∫—Ç
2. **APIs & Services ‚Üí Credentials ‚Üí OAuth 2.0 Client**
3. –í **Authorized redirect URIs** –¥–æ–±–∞–≤—å—Ç–µ:
   ```
   https://moodflow-six.vercel.app/callback
   https://moodflow-six.vercel.app/api/auth/callback
   ```
4. **APIs & Services ‚Üí OAuth consent screen**
5. –í **Authorized domains** –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `vercel.app`

### –®–∞–≥ 4: –¢–µ—Å—Ç (3 –º–∏–Ω—É—Ç—ã)
1. –û—Ç–∫—Ä–æ–π—Ç–µ APK –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ
2. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google"
3. –ó–∞–≤–µ—Ä—à–∏—Ç–µ –≤—Ö–æ–¥ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
4. –ó–∞–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä
5. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
6. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 2-5 —Å–µ–∫—É–Ω–¥
7. ‚úÖ –î–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—å

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–æ–∑–¥–∞–Ω–æ 6 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:

1. **START_HERE_MOBILE_AUTH.md** ‚≠ê - **–ù–ê–ß–ù–ò–¢–ï –û–¢–°–Æ–î–ê**
2. **DEPLOY_MOBILE_AUTH_CHECKLIST.md** - –ø–æ–ª–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç –¥–µ–ø–ª–æ—è
3. **MOBILE_APP_OAUTH_SETUP.md** - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
4. **QUICKSTART_MOBILE_AUTH.md** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
5. **USER_LOGIN_INSTRUCTION.md** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
6. **GET_PACKAGE_NAME.md** - –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å assetlinks.json

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è

- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –Ω–∞—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç custom URL schemes
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ —Å TWA/PWA
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ JavaScript
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤ –≤–µ–± –∏ APK
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ Google Play Console

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
1. **–ó–∞–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä** (—Å–≤–∞–π–ø –≤–≤–µ—Ä—Ö / –∫–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥)
2. **–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
3. **–ü–æ–¥–æ–∂–¥–∏—Ç–µ 2-5 —Å–µ–∫—É–Ω–¥** - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
4. –ì–æ—Ç–æ–≤–æ! ‚úÖ

---

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —É—Å–ø–µ—à–Ω–æ –≤—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ Google –≤ APK
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ deep linking
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö

**–í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:** 10 –º–∏–Ω—É—Ç  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É ‚úÖ

---

## üìû –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 5 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - –∑–∞–∫—Ä–æ–π—Ç–µ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–Ω–æ–≤–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ redirect URLs –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ Supabase –∏ Google
4. –û—Ç–∫—Ä–æ–π—Ç–µ **DEPLOY_MOBILE_AUTH_CHECKLIST.md** –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ troubleshooting

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥

–û—Ç–∫—Ä–æ–π—Ç–µ **START_HERE_MOBILE_AUTH.md** –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º!

