# üöÄ –§–ò–ù–ê–õ–¨–ù–´–ô –î–ï–ü–õ–û–ô - –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥–æ—Ç–æ–≤—ã!

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. ‚úÖ TypeScript –æ—à–∏–±–∫–∞ `Property 'user_id' does not exist on type 'never'` 
2. ‚úÖ TypeScript –æ—à–∏–±–∫–∞ `Property 'sso_uid' does not exist on type 'never'`
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–ª—è `users` –∏ `psychologists`
4. ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã

## üìã –°–ï–ô–ß–ê–° –î–ï–õ–ê–ô–¢–ï:

### 1Ô∏è‚É£ –ó–∞–ø—É—à—å—Ç–µ –∫–æ–¥ (30 —Å–µ–∫—É–Ω–¥)

```bash
cd /Users/d.chistoforov/Desktop/MoodFlow
git push
```

### 2Ô∏è‚É£ –î–æ–∂–¥–∏—Ç–µ—Å—å –¥–µ–ø–ª–æ—è (2-3 –º–∏–Ω—É—Ç—ã)

- –û—Ç–∫—Ä–æ–π—Ç–µ https://vercel.com/dashboard
- –ù–∞–π–¥–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç MoodFlow
- –î–æ–∂–¥–∏—Ç–µ—Å—å —Å—Ç–∞—Ç—É—Å–∞ **"Ready"** ‚úÖ (–∑–µ–ª–µ–Ω–∞—è –≥–∞–ª–æ—á–∫–∞)

### 3Ô∏è‚É£ –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –≤ Supabase (2 –º–∏–Ω—É—Ç—ã)

**–í–ê–ñ–ù–û:** –≠—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —à–∞–≥!

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://supabase.com/dashboard
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç MoodFlow
3. SQL Editor ‚Üí New Query
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **–í–ï–°–¨** —Ñ–∞–π–ª `SIMPLE_FIX_ADMIN.sql`
5. –í—Å—Ç–∞–≤—å—Ç–µ –∏ –Ω–∞–∂–º–∏—Ç–µ **Run** (–∏–ª–∏ Cmd+Enter)
6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ SELECT:
   - `admin_role`: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `admin` ‚úÖ
   - `active`: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `true` ‚úÖ

### 4Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. **–ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à**: Cmd+Shift+R (Mac) –∏–ª–∏ Ctrl+Shift+F5 (Windows)
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏"**

## üéâ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 3

Email                          | –ò–º—è                | –†–æ–ª—å    | –î–∞—Ç–∞
-------------------------------|--------------------|---------|-----------------
dashalala02@gmail.com          | Dubrovskaia Daria  | [–≤—ã–±–æ—Ä] | 3 –Ω–æ—è–±—Ä—è 2025 –≥.
site4people@gmail.com          | Daniil Chistoforov | –ê–¥–º–∏–Ω ‚úÖ | 3 –Ω–æ—è–±—Ä—è 2025 –≥.
d.chistoforov@health-samurai.io| Daniil Chistoforov | [–≤—ã–±–æ—Ä] | 3 –Ω–æ—è–±—Ä—è 2025 –≥.
```

## üîç –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –æ—Ç–≤–µ—Ç –≤ DevTools:

1. F12 ‚Üí Network
2. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
3. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å `/api/admin/users`
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ Response

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```json
{
  "users": [
    {
      "email": "site4people@gmail.com",
      "subscription_tier": "free",
      "effective_role": "admin"  ‚Üê –≠–¢–û –ö–õ–Æ–ß–ï–í–û–ï –ü–û–õ–ï!
    }
  ]
}
```

### –ï—Å–ª–∏ `effective_role` = `"free"`:
‚Üí –ó–Ω–∞—á–∏—Ç –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ SQL —Å–∫—Ä–∏–ø—Ç (–®–∞–≥ 3)

### –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ 403:
‚Üí –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç - –æ–Ω —Å–æ–∑–¥–∞–µ—Ç RLS –ø–æ–ª–∏—Ç–∏–∫–∏

### –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –ø—Ä–æ–±–ª–µ–º—ã:
‚Üí –û—Ç–∫—Ä–æ–π—Ç–µ `DIAGNOSIS_STEPS.md` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

## üìù –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫:

- [ ] git push –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] Vercel –¥–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω (—Å—Ç–∞—Ç—É—Å Ready)
- [ ] SQL —Å–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ Supabase
- [ ] –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ SQL –≤–∏–¥–Ω–æ: admin_role='admin', active=true
- [ ] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞ (Shift+F5)
- [ ] –í–∏–∂—É —Ä–æ–ª—å "–ê–¥–º–∏–Ω" —É site4people@gmail.com ‚úÖ

---

## üí° –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏:

### –î–æ:
```typescript
const psychologistMap = new Map(
  psychologists?.map(p => [p.user_id, p]) || []  // ‚ùå TypeScript –Ω–µ –∑–Ω–∞–ª —Ç–∏–ø
)

const usersWithRoles = users?.map(user => {      // ‚ùå TypeScript –Ω–µ –∑–Ω–∞–ª —Ç–∏–ø
  const psychologistData = psychologistMap.get(user.sso_uid);
  // ...
})
```

### –ü–æ—Å–ª–µ:
```typescript
type User = Database['public']['Tables']['users']['Row']
type PsychologistData = { user_id: string; role: string; active: boolean }

const psychologistMap = new Map<string, PsychologistData>(
  (psychologists as PsychologistData[] | null)?.map(p => [p.user_id, p]) || []
)

const usersWithRoles = (users as User[] | null)?.map(user => {
  const psychologistData = psychologistMap.get(user.sso_uid);
  // ...
})
```

‚úÖ –¢–µ–ø–µ—Ä—å TypeScript —Ç–æ—á–Ω–æ –∑–Ω–∞–µ—Ç —Ç–∏–ø—ã –∏ –∫–æ–º–ø–∏–ª—è—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ!

